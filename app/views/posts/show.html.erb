<% content_for :title, post_title(@post).to_s %>

<div class="row-fluid">
  <div class="col-sm-8 col-xs-12 well">
    <div class="col-xs-12">
      <h2><%= @post.title %></h2>
      <% if @post.images.count > 0 %>
        <%= render partial: 'image', collection: @post.images %>
      <% end %>
    </div>
  </div>
  <div class="col-xs-12 col-sm-4">
    <div class="col-xs-12">
      <div class="well">
        <p>
          <span class="price"><%= number_to_currency(@post.price, precision: 0) %></span>
          <span class="size">Size: <%= @post.size.name %></span>
        </p>
        <dl>
          <dt>Overview</dt>
          <dd><%= @post.body %></dd>
        </dl>

        <div>
          <%= render partial: "posts/post/#{@post.status}", locals: {post: @post, user: @post.user} %>
        </div>

      </div>
    </div>
    <div class="col-xs-12">
      <div class="well">
        <%= render partial: 'post_owner_actions' %>
        <ul>
          <li>Seller: <%= link_to @post.user.username, user_path(@post.user) %></li>
          <% if @post.impressions_count > 15 %>
            <li>Views: <%= @post.impressions_count %></li>
          <% end %>
          <li>Status: <%= @post.status %></li>
        </ul>
      </div>
    </div>


    <div class="col-xs-12">
      <div class="well">
        <div class="list-group">
          <div class="list-group-item comments">
            <span class="badge"><%= @post.comments.count %></span>
            <h4 class="list-group-item-heading">Comments</h4>
          </div>
          <%= render partial: "comments/comment", collection: @post.comments %>
          <div class="list-group-item">
            <% if current_user %>
              <h3 class="list-group-item-heading">Submit a Comment</h3>

              <%= simple_form_for [@post, @post.comments.build(post_id: @post.id)] do |f| %>
                <%= f.input :body, input_html: {rows: 6}, label: false %>
                <br>
                <%= f.submit :submit, class: 'btn btn-inverse' %>
              <% end %>

            <% else %>
              <%= link_to "Login to Comment", login_path %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>


</div>

<!-- facebook meta -->
<%= render partial: "elements/meta", object: {
  title: "#{@post.title}, size: #{@post.size.name} #{number_to_currency(@post.price, precision: 0)}",
  type: 'pair',
  info: @post.body,
  published_at: @post.created_at,
  popularity: @post.cached_votes_score,
  id: @post.id,
} %>
<!--end facebook meta-->
<!-- twitter meta -->
<%= render partial: "twitter_card", locals: {post: @post} %>
<!-- end twitter meta -->